define(["app"],function(e){return e.module("Entities.Profile",function(e,t,n,r,i,s){e.Profile=n.Model.extend({schema:{about:{validators:["required"]},seeking:{type:"Select",options:["men","women","both"]},gender:{type:"Select",options:["male","female","other"]},birthday:{type:"Date",yearEnd:1995},you_want:"Text"},sync:function(e,t,n){t.unset("profile_photo");var r=this;return c=t.attributes,e=="create"?methodType="POST":e=="update"?methodType="PUT":e=="read"?methodType="GET":e=="delete"&&(methodType="DELETE"),c.youWant=c.you_want,delete c.you_want,params=s.extend({type:methodType,crossDomain:!0,dataType:"json",url:t.url()},n),e!=="read"&&(params=s.extend({data:{social_profile:c,_format:"json"}},params)),i.ajax(params)},userId:null,initialize:function(e){this.userId=e.userId},url:function(){var e=null;return typeof this.get("userId")=="undefined"?e=this.id:e=this.get("userId"),window.api_endpoint+"/api/users/"+e+"/profiles"}});var o={getProfileEntity:function(t){var n=new e.Profile({id:t}),r=i.Deferred();return n.fetch({success:function(e){r.resolve(e)},error:function(e){r.resolve(undefined)}}),r.promise()}};t.reqres.setHandler("profile:entity",function(e){return o.getProfileEntity(e)}),t.reqres.setHandler("profile:entity:new",function(t){return new e.Profile({userId:t})})}),e.Entities.Profile});