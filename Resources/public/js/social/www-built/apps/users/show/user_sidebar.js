define(["app","handlebars","text!apps/users/show/templates/user_sidebar.html","util/lazyloaderhelper"],function(e,t,n,r){return e.module("UsersApp.Show.Sidebar.View",function(e,r,i,s,o,u){e.View=s.ItemView.extend({template:t.compile(n),initialize:function(){this.model.on("change",this.render,this)},events:{"click #chat-with-user":"chatWithUser"},chatWithUser:function(){var e=this,t=r.request("user:entity:me",window.user_id);o.when(t).done(function(t){var n=e.model;r.sendEventAnalytics("event","Users","Chat",n.get("id"));var i={"private":n.get("username"),nick:t.get("username")};r.trigger("chat:show",i)})},templateHelpers:function(){var e={};if(typeof this.model.get("city")!="undefined"){var t;this.model.get("city").name==="no_city"?t=this.model.get("city").country.name:t=this.model.get("city").name+" ,"+this.model.get("city").country.name,e.getLocation=t}if(typeof this.model.get("profile")!="undefined"){var n=(new Date).getFullYear(),r=moment(this.model.get("profile").birthday).year().toString().substring(0,4),i=n-r;i<=0&&(i=">18"),e.yearsOld=i}return moment?e.dateLastLogin=moment(this.model.get("last_login")).format("dddd DD.MM.YYYY HH:mm"):e.dateLastLogin=this.model.get("last_login"),e}})}),e.UsersApp.Show.Sidebar.View});