define(["app","text!apps/users/show/templates/user_tabs.html","handlebars","apps/commons/pagination/paginate","util/util"],function(e,t,n,r){return e.module("UsersApp.Show.Tabs.View",function(e,r,i,s,o,u){e.View=s.ItemView.extend({template:n.compile(t),events:{"click #photos":"_renderPhotos","click #show_user":"renderShowUser","click #message":"_messageTab"},render:function(){var e=this;return n.registerHelper("isNotMeProfile",function(t){return e.model.id!==window.user_id?t.fn(this):t.inverse(this)}),this.$el.html(this.template(this.model.attributes)),this},renderShowUser:function(e){removeAndAddClass("li","active","#tabShowUser"),e.preventDefault(),r.trigger("users:show",this.model.get("username_canonical"),this.model.get("id"))},_renderPhotos:function(e){e.preventDefault(),r.trigger("users:photos:list",this.model.get("id"))},_messageTab:function(e){e.preventDefault(),r.trigger("users:messages:send",this.model.get("id"))},message:function(e){var t=this;removeAndAddClass("li","active","#tabMessage"),requirejs(["entities/threads","apps/messages/composer/compose_view","text!apps/users/show/templates/compose_form.html","text!apps/users/show/templates/compose_form_layout.html"],function(r,i,s,o){var a=new r.NewThread({recipient:e.get("username")}),f=new i.ComposeView({model:a,template:n.compile(o),formTemplate:s});f.on("compose:submit",u.bind(t._sendMessage,t)),t.options.region.users_show_Region.show(f)})},_sendMessage:function(e){var t=this;e.save(null,{success:function(){r.sendEventAnalytics("event","Users","Message",t.model.get("id")),t._messageSended()}})},_messageSended:function(){var t=this;requirejs(["text!apps/users/show/templates/message_successfull_sended.html"],function(r){e.MessageSuccessfulSended=s.ItemView.extend({template:n.compile(r)}),t.options.region.users_show_Region.show(new e.MessageSuccessfulSended)})}})}),e.UsersApp.Show.Tabs.View});