define(["app"],function(e){return e.module("CommonsApp.Pageable",function(e,t,n,r,i,s){var o=12,u=n.PageableCollection.extend({url:window.api_endpoint+"/api/channels?limit=6",state:{pageSize:15,sortKey:"updated",order:1},queryParams:{totalPages:null,totalRecords:null,sortKey:"sort",q:"state:closed repo:jashkenas/backbone"},mode:"client"}),a=new u,f=new Backgrid.Grid({columns:columns,collection:territories}),l=new Backgrid.Extension.Paginator({collection:a});e.Collection=Paginator.clientPager.extend({initialize:function(e){typeof e!="undefined"&&(this.paginator_core.url=e.data.url),this.on("add",this.addModel,this),this.on("remove",this.removeModel,this),this.setDefaults()},model:Channel,paginator_ui:{firstPage:1,currentPage:1,perPage:o,totalPages:10,pagesInRange:4},paginator_core:{type:"GET",dataType:"jsonp",url:window.api_endpoint+"/app_dev.php/api/channels"},parse:function(e){return this.totalPages=Math.ceil(e.total/o),e.resources},sync:function(e,t,n){var r=this,o=s.extend({dataType:"json",url:r.paginator_core.url},n);return i.ajax(o)}});var c=r.Layout.extend({template:ChannelListItemTpl,tagName:"span",className:"col-xs-3",serializeData:function(){return this.model.attributes},templateHelpers:function(){return{markdown:function(e){return markdown.toHTML(e)}}}}),h=r.View.extend({initialize:function(){var e=this.collection;e.on("reset",this.addAll,this)},addAll:function(){var e=this;requirejs(["text!"+this.options.myTemplate],function(t){e.$el.empty(),e.collection.each(function(n){var r=new c({model:n,template:t});e.$el.append(r.render().el)})})},addOne:function(e){var t=new c({model:e});i("#body_container_center").append(t.render().el)}}),p=r.ItemView.extend({template:PaginationTemplate,className:"pagination pagination-centered",events:{"click .prev":"gotoPrev","click .next":"gotoNext","click .page":"gotoPage"},gotoPrev:function(){return this.collection.prevPage(),this.render(),!1},gotoPage:function(e){var t=i(e.target).text();return this.collection.goTo(t),this.render(),!1},gotoNext:function(e){return this.collection.nextPage(),this.render(),!1},serializeData:function(){return this.collection},initialize:function(){},render:function(){var e=s.template(PaginationTemplate,this.collection);i(this.el).html(e)}});e.ViewsChannels=r.Layout.extend({template:ChannelListTemplate,regions:{list_region:".list_region",pages_region:".pages"},onRender:function(){var e=this;e.list_region.show(new h({collection:this.collection,myTemplate:e.options.myTemplate})),this.collection.fetch({reset:!0,success:function(t){t.pager(),e.pages_region.show(new p({collection:t}))},error:function(e){},silent:!0})}})}),e.CommonsApp.Pageable});