define(["app","paginator","models/channel","text!templates/ChannelListTemplate.html","text!templates/pagination.html","text!templates/ChannelListItemTpl.html"],function(e,t,n,r,i,s){return e.module("CommonsApp.PaginationChannel",function(e,o,u,a,f,l){var c=12;e.Collection=t.clientPager.extend({initialize:function(e){typeof e!="undefined"&&(this.paginator_core.url=e.data.url),this.on("add",this.addModel,this),this.on("remove",this.removeModel,this),this.setDefaults()},model:n,paginator_ui:{firstPage:1,currentPage:1,perPage:c,totalPages:10,pagesInRange:4},paginator_core:{type:"GET",dataType:"jsonp",url:window.api_endpoint+"/app_dev.php/api/channels"},parse:function(e){return this.totalPages=Math.ceil(e.total/c),e.resources},sync:function(e,t,n){var r=this,i=l.extend({dataType:"json",url:r.paginator_core.url},n);return f.ajax(i)}});var h=a.Layout.extend({template:s,tagName:"span",className:"col-xs-3",serializeData:function(){return this.model.attributes},templateHelpers:function(){return{markdown:function(e){return markdown.toHTML(e)}}}}),p=a.View.extend({initialize:function(){var e=this.collection;e.on("reset",this.addAll,this)},addAll:function(){var e=this;requirejs(["text!"+this.options.myTemplate],function(t){e.$el.empty(),e.collection.each(function(n){var r=new h({model:n,template:t});e.$el.append(r.render().el)})})},addOne:function(e){var t=new h({model:e});f("#body_container_center").append(t.render().el)}}),d=a.ItemView.extend({template:i,className:"pagination pagination-centered",events:{"click .prev":"gotoPrev","click .next":"gotoNext","click .page":"gotoPage"},gotoPrev:function(){return this.collection.prevPage(),this.render(),!1},gotoPage:function(e){var t=f(e.target).text();return this.collection.goTo(t),this.render(),!1},gotoNext:function(e){return this.collection.nextPage(),this.render(),!1},serializeData:function(){return this.collection},initialize:function(){},render:function(){var e=l.template(i,this.collection);f(this.el).html(e)}});e.ViewsChannels=a.Layout.extend({template:r,regions:{list_region:".list_region",pages_region:".pages"},onRender:function(){var e=this;e.list_region.show(new p({collection:this.collection,myTemplate:e.options.myTemplate})),this.collection.fetch({reset:!0,success:function(t){t.pager(),e.pages_region.show(new d({collection:t}))},error:function(e){},silent:!0})}})}),e.CommonsApp.PaginationChannel});