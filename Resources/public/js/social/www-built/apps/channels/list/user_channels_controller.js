define(["app","apps/channels/list/list_view","apps/commons/pagination/paginate","apps/commons/list/listView","entities/user"],function(e,t,n,r){return e.module("ChannelsApp.List",function(e,i,s,o,u,a){var f=null;e.UserChannelsController={showChannelsUserOwnes:function(t,n){var r=i.request("user:entity",t),s="users/"+t+"/channels/owner/";u.when(r).done(function(r){var i=window.api_endpoint+"/api/users/"+t+"/channels",o="Channels owned by "+r.get("username");e.UserChannelsController._getChannelseOfUser(i,o,n,s)})},showChannelsUserModerates:function(t,n){var r=i.request("user:entity",t),s="users/"+t+"/channels/moderator/";u.when(r).done(function(r){var i=window.api_endpoint+"/api/users/"+t+"/moderated",o="Channels moderated by "+r.get("username");e.UserChannelsController._getChannelseOfUser(i,o,n,s)})},showChannelsUserIsFan:function(t,n){var r=i.request("user:entity",t),s="users/"+t+"/channels/fan/";u.when(r).done(function(r){var i=window.api_endpoint+"/api/users/"+t+"/channelsFan",o="Channels wich "+r.get("username")+" is fan";e.UserChannelsController._getChannelseOfUser(i,o,n,s)})},_getChannelseOfUser:function(s,o,u,a){u?u=parseInt(u):u=1;var f=new t.UsersChannelsLayout({title:o}),l;l=new n.Collection({url:s});var c=new n.Layout,h=new r.Loading({message:"Reading Channels."});f.on("show",function(){c.on("render",function(){e.UserChannelsController._fetchChannelCollection(l,c,u,a)}),c.on("show",function(){c.pages_region.show(h)}),f.index_medium_Region.show(c)}),i.container_center_Region.show(f)},_fetchChannelCollection:function(e,r,s,o){requirejs(["text!apps/channels/list/templates/composite_list_template.html"],function(u){e.fetch({reset:!0,success:function(a){var l=new n.PaginationView({collection:e});e.getPage(s);var c=function(){return f===null?"":"?"+f};l.on("goToPage",function(e){i.navigate(o+e)}),l.on("gotoNext",function(e){i.navigate(o+e)}),l.on("goToPrev",function(e){i.navigate(o+e)}),r.pages_region.show(l),r.list_region.show(new t.ItemsListView({collection:e,template:u,columns:6}))},error:function(e,t,n){requirejs(["apps/commons/errors/generic"],function(e){i.container_center_Region.show(new e.GenericErrorView({model:t}))})},silent:!0})})}}}),e.ChannelsApp.List.UserChannelsController});