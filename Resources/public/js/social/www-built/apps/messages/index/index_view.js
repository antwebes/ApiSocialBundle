define(["app","text!apps/messages/index/templates/layout.html","text!apps/messages/index/templates/index.html","text!apps/messages/index/templates/item.html","text!apps/messages/index/templates/messages.html","text!apps/messages/index/templates/message.html","text!apps/messages/index/templates/no_messages.html","apps/commons/dialog/dialog_view","handlebars"],function(e,t,n,r,i,s,o,u,a){return e.module("MessagesApp.Index.View",function(e,f,l,c,h,p){e.Layout=c.Layout.extend({template:a.compile(t),events:{"click #compose":"composeLinkClicked","click #inbox-tab":"inboxClicked","click #sent-tab":"sentClicked"},regions:{mainRegion:"#main"},composeLinkClicked:function(e){return e.preventDefault(),e.stopPropagation(),this.trigger("thread:compose"),!1},inboxClicked:function(e){return e.preventDefault(),e.stopPropagation(),this.trigger("inbox"),!1},sentClicked:function(e){return e.preventDefault(),e.stopPropagation(),this.trigger("sent"),!1},setActiveTab:function(e){var t=this,n=function(){t.$el.find("#inbox-tabs li").removeClass("active"),t.$el.find("#"+e).addClass("active")};this.on("item:rendered",function(){n(),t.hasBeenRendered=!0}),this.hasBeenRendered&&n()}}),e.Thread=c.ItemView.extend({tagName:"div",template:a.compile(r),events:{"click .message-item":"navigate"},navigate:function(e){$e=h(e.target);if(!$e.hasClass("external"))return e.preventDefault(),this.trigger("thread:show",this.model),!1}}),e.Message=c.ItemView.extend({tagName:"div",template:a.compile(s)}),e.NoMessages=c.ItemView.extend({template:a.compile(o)}),e.Threads=c.CompositeView.extend({tagName:"div",template:a.compile(n),itemView:e.Thread,emptyView:e.NoMessages}),e.Messages=c.CompositeView.extend({template:a.compile(i),itemView:e.Message,itemViewContainer:"#messages",events:{"click #reply":"replyClicked","click #delete":"deleteClicked","click .btn-back-message-list":"back"},appendHtml:function(e,t,n){var r=this.$el.find("#messages");r.prepend(t.el)},replyClicked:function(e){e.preventDefault(),e.stopPropagation(),this.trigger("thread:reply",this.collection.models[0].get("thread"))},deleteClicked:function(e){e.preventDefault(),e.stopPropagation();var t=this,n=f.request("trans","messages::delete_thread_title"),r=f.request("trans","messages::delete_thread_message");u.confirm(r,n).then(function(e){e&&t.trigger("thread:delete",t.collection.models[0].get("thread"))})},showReply:function(e){this.$el.find("#replay-container").html(e.render().el)},back:function(e){return e.preventDefault(),e.stopPropagation(),this.trigger("thread:back"),!1}})}),e.MessagesApp.Index.View});