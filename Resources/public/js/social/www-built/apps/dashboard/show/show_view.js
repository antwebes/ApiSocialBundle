define(["app","apps/commons/list/listView","text!apps/dashboard/show/templates/Layout_Template.html","text!apps/dashboard/show/templates/dashboard_Template.html","text!apps/dashboard/show/templates/list_photos.html","handlebars"],function(e,t,n,r,i,s){var o=null;return e.module("DashboardApp.Show.View",function(e,o,u,a,f,l){e.create=function(n){if(!o.DashboardApp.Show.dashboardLayout||!o.DashboardApp.Show.dashboardLayout.content_Region){var r=o.request("user:entity:me",window.user_id),i=new t.Loading({message:"Reading User."});o.body_container_main_Region.show(i),f.when(r).done(function(t){var r=new e.Layout({model:t});o.DashboardApp.Show.dashboardLayout=r,r.on("show",function(){r.content_Region.show(n)}),o.body_container_main_Region.show(r)})}else o.DashboardApp.Show.dashboardLayout.content_Region.show(n)},e.Layout=a.Layout.extend({template:n,triggers:{"click #channels_list":"dashboard:channels_moderated","click #channels_pendings_list":"dashboard:channels_pendings_to_moderate","click #channels_fan":"dashboard:channels_fan","click #channels_is_moderator":"dashboard:channels_is_moderator","click #create_channel_from_dashboard":"dashboard:create_channel","click #go_me_edit":"user:edit"},regions:{content_Region:".content-show"},initialize:function(){var e=this;this.on("dashboard:channels_moderated",function(){o.trigger("dashboard:channels_moderated")}),this.on("dashboard:channels_pendings_to_moderate",function(){o.trigger("dashboard:channels_pendings_to_moderate")}),this.on("dashboard:channels_fan",function(){o.trigger("dashboard:channels_fan")}),this.on("dashboard:channels_is_moderator",function(){o.trigger("dashboard:channels_is_moderator")}),this.on("dashboard:change_profile_photo",function(){o.trigger("dashboard:change_profile_photo")}),this.on("dashboard:create_channel",function(){o.trigger("dashboard:create_channel")}),this.on("user:edit",function(){o.trigger("user:edit")}),this.on("render",function(){e.options.subView&&e.content_Region.show(e.options.subView)}),this.options.holder&&this.options.holder.show(this)},templateHelpers:function(){var e={};return e.enabled=[],e.disabled=[],this.model.get("channels")&&this.model.get("channels").length>0&&(enabled=this.model.get("channels").where({enabled:!0}),disabled=this.model.get("channels").where({enabled:!1}),e.enabled=enabled,e.disabled=disabled),e}}),e.Dashboard=a.ItemView.extend({template:r,className:"page-content",initialize:function(){},showChannels:function(e){e.preventDefault(),this.trigger("dashboard:channels_moderated",1)},showChannelsPendings:function(e){e.preventDefault(),this.trigger("dashboard:channels_pendings_to_moderate",0)},onShow:function(){f.ajax({type:"GET",contentType:"application/json",dataType:"json",url:window.api_endpoint+"/api/users/"+window.user_id+"/channels?enabled="+0,success:function(e){f("#channels_pendings_list span:first").text(e.total)},error:function(e,t,n){}})}}),e.ListPhoto=u.Marionette.ItemView.extend({template:s.compile(i),tagName:"li",events:{"click a":"photoClicked"},photoClicked:function(){var e=this;require(["apps/commons/dialog/dialog_view"],function(t){t.confirm("Are you sure you want to change the profile photo?","Change profile photo").then(function(t){t&&e.trigger("dashboard:assigne_profile_photo",e.model)})})}})}),e.DashboardApp.onStop=function(){e.DashboardApp.Show.dashboardLayout=null,o=null},e.DashboardApp.Show.View});