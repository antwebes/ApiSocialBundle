define(["app","apps/dashboard/show/show_view","apps/commons/list/listView","entities/user"],function(e,t,n){return e.module("DashboardApp.Show",function(e,r,i,s,o,u){e.Controller={show:function(){var i=r.request("user:entity:me",window.user_id),s=new n.Loading({message:"Reading User."});r.body_container_main_Region.show(s),o.when(i).done(function(n){var i=new t.Layout({model:n});e.dashboardLayout=i,r.DashboardApp.Show.dashboardLayout=i,i.on("show",function(){i.content_Region.show(new t.Dashboard({model:n}))}),r.body_container_main_Region.show(i)}).fail(function(e){requirejs(["apps/commons/errors/generic"],function(t){r.container_center_Region.show(new t.GenericErrorView({model:e}))})})},createChannel:function(){require(["apps/channels/form/formViewSeparateLayoutAndView","apps/commons/form/ant_backbone_form","text!apps/channels/form/templates/form_create_layout_Template.html","text!apps/channels/form/templates/form_view_template.html","handlebars","entities/channel"],function(e,n,i,s,u){var a=r.request("channel:entity:new");o.when(a).done(function(a){var f=new n({model:a,template:u.compile(s)}),l=new e.Layout({model:a,form:f,type:"create",template:i});l.on("show",function(){l.form_Region.show(new e.FormView({model:a,type:"create",form:f}))});if(r.DashboardApp.Show.dashboardLayout)r.DashboardApp.Show.dashboardLayout.content_Region.show(l);else{var c=r.request("user:entity:me",window.user_id);o.when(c).done(function(e){var n=new t.Layout({model:e});r.DashboardApp.Show.dashboardLayout=n,n.on("show",function(){n.content_Region.show(l)}),r.body_container_main_Region.show(n)})}})})},changeProfilePhoto:function(){requirejs(["apps/photos/upload/upload_view","entities/user","jquery.ui.widget","jquery.fileupload-process","jquery.fileupload","jquery.fileupload-image","load-image","canvas-to-blob","jquery_iframe_transport"],function(n){var i=r.request("user:entity:me",window.user_id);o.when(i).done(function(r){var i=new t.Dashboard({model:r}),s=new n.FormItem({configure:{message:"Change profile photo",checked:!0,profile_hidden:!0,after_upload_callback:e.Controller.afterUpload}});t.create(s)})})},afterUpload:function(){r.trigger("users:navbar:me"),r.trigger("dashboard:show")},chooseProfilePhoto:function(){requirejs(["apps/photos/list/list_view","entities/photo"],function(n){var i=r.request("photo:entities",window.user_id);o.when(i).done(function(r){var i=new n.ListarPhotos({itemView:t.ListPhoto,collection:r});i.on("itemview:dashboard:assigne_profile_photo",function(t){e.Controller.assigneProfilePhoto(t.model)}),t.create(i)})})},assigneProfilePhoto:function(t){r.request("user:profile_photo:assigne",window.user_id,t.get("id"),e.Controller.afterUpload,e.Controller.afterUpload)}}}),e.DashboardApp.Show.Controller});